<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="seroepirecipes"><title>Serocatalytic models • seroepirecipes</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Serocatalytic models"><meta property="og:description" content="seroepirecipes"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seroepirecipes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/antibody_kinetics_models.html">Antibody kinetics models</a>
    <a class="dropdown-item" href="../articles/serocatalytic_model.html">Serocatalytic models</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/seroanalytics/seroepirecipes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Serocatalytic models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/seroanalytics/seroepirecipes/blob/HEAD/vignettes/serocatalytic_model.Rmd" class="external-link"><code>vignettes/serocatalytic_model.Rmd</code></a></small>
      <div class="d-none name"><code>serocatalytic_model.Rmd</code></div>
    </div>

    
    
<div id="serocatalytic-models" class="section level1">
<h1>Serocatalytic models</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(seroepirecipes)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Loading required package: StanHeaders</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; rstan version 2.32.3 (Stan version 2.26.1)</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; rstan_options(auto_write = TRUE)</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; change `threads_per_chain` option:</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; rstan_options(threads_per_chain = 1)</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; This is bayesplot version 1.10.0</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; - Online documentation and vignettes at mc-stan.org/bayesplot</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; - bayesplot theme set to bayesplot::theme_default()</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt;    * Does _not_ affect other ggplot2 plots</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;    * See ?bayesplot_theme_set for details on theme setting</span></span></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Serocatalytic models are used to model seroprevalence over time or
age in cross-sectional serosurveys as a function of the Force of
Infection (FOI) – the per capita rate (per year) that susceptible
individuals seroconvert either through infection or vaccination. In this
vignette, we will demonstrate how a simple serocatalytic model can be
fitted to age-stratified seroprevalence data using both a frequentist
framework (using <code>glm</code>) and Bayesian framework (using
<code>Stan</code>).</p>
</div>
<div id="other-resources" class="section level2">
<h2>Other resources</h2>
<p>There are two R packages for fitting serocatalytic models to
seroprevalence data: <a
href="https://epiverse-trace.github.io/serofoi/">serofoi</a> and <a
href="https://github.com/nathoze/Rsero">Rsero</a>. Both packages provide
implementations of the basic serocatalytic model and common extensions.
An excellent resource for learning about the serocatalytic model is
Chapter 4 of the textbook <a
href="https://link.springer.com/book/10.1007/978-3-319-97487-3"><em>Epidemics:
Models and Data using R</em> by Ottar N. Bjørnstad</a>.</p>
</div>
<div id="data-requirements" class="section level2">
<h2>Data requirements</h2>
<p>Data requirements for the serocatalytic model are simple: the minimum
variables required are the proportion of seropositive individuals
stratified by age group. Note that inferences can only be drawn for time
periods for which individuals in the sample were alive. Additionally,
having seropositivity at multiple timepoints can allow an assessment of
changes in FOI over time. Differences in FOI between sub-populations or
demographic groups can also be measured using serocatalytic models (see
Table 1)</p>
<table>
<caption>Table 1 : Minimum variables required for serocatalytic model
depending on use case</caption>
<colgroup>
<col width="15%" />
<col width="35%" />
<col width="49%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Use case</th>
<th align="left">Minimum variables</th>
<th align="left">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Population-wide FOI</td>
<td align="left">Proportion seropositive by age</td>
<td align="left">Estimating ascertainment rates, population-level
seroprevalence, average age at first infection</td>
</tr>
<tr class="even">
<td align="left">Age-specific FOI</td>
<td align="left">Proportion seropositive by age</td>
<td align="left">Timing of historical outbreaks</td>
</tr>
<tr class="odd">
<td align="left">Changes in FOI over time</td>
<td align="left">Proportion seropositive by age, time and
population</td>
<td align="left">Timing of historical outbreaks, impact of
interventions, changes in transmission rates over time</td>
</tr>
<tr class="even">
<td align="left">Changes in FOI in different populations</td>
<td align="left">Proportion seropositive by age and/or time,
seroreversion rate (known or estimated from data)</td>
<td align="left">Impact of interventions on different populations and
over time</td>
</tr>
<tr class="odd">
<td align="left">FOI with seroreversion</td>
<td align="left">Proportion seropositive by age and/or time,
seroreversion rate (known or estimated from data)</td>
<td align="left">In cases where immunity wanes and is not lifelong, can
be used to estimate the force of infection and duration of
seropositivity</td>
</tr>
</tbody>
</table>
</div>
<div id="the-model" class="section level2">
<h2>The model</h2>
<p>The simplest catalytic model assumes:</p>
<ul>
<li>The FOI is constant across ages and over time</li>
<li>There is no seroreversion (once individuals become seropositive,
they remain seropositive indefinitely)</li>
<li>No boosting of antibody response (individuals are either
seropositive or seronegative)</li>
<li>There is no cross-reactivity to other pathogens</li>
<li>The population size is stable</li>
</ul>
<p>Under this model, the rate of change of susceptible individuals
(<span class="math inline">\(S\)</span>) with age (<span
class="math inline">\(a\)</span>) is expressed as:</p>
<p><span class="math display">\[
\frac{dS}{dt} = -\lambda S(a)
\]</span> where <span class="math inline">\(\lambda\)</span> is the
constant FOI.</p>
<p>The proportion of the population seropositive at age <span
class="math inline">\(a\)</span>, <span
class="math inline">\(\pi(a)\)</span> can then be solved as: <span
class="math display">\[
\pi(a)= 1-exp(-\lambda a)
\]</span></p>
<p>Note either age (<span class="math inline">\(a\)</span>) or time
(<span class="math inline">\(t\)</span>) could be used in the example
above. The definition of seropositivity is important – for quantitative
and semi-quantitative assays such as ELISA, a threshold must be chosen
above which individuals are considered seropositive. This threshold is
usually based on known antibody measurement distributions from
individuals who are known to have been exposed or not.</p>
<div
id="example-seroprevalence-of-measles-neutralising-antibodies-in-new-haven-usa-in-the-1950s"
class="section level3">
<h3>Example: seroprevalence of measles neutralising antibodies in New
Haven, USA in the 1950s</h3>
<p>For this example, we are fitting to a dataset from the book
“Epidemics: Models and Data using R” by Ottar Bjornstad, Chapter 4-3. We
can see that we have age bands, the median age within that band, the
number of samples in that band, the number positive and negative, and
the seroprevalence in that age band (f). For this example we will subset
the data, excluding the &lt;1, 40-49 and 50+ brackets.</p>
<p>&lt;&lt; NOTE: this data comes from the Black et al. 1959 paper
directly, so we can pull it ourselves and include in seroepirecipes.
&gt;&gt;</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="do">## For now, fit to data from &quot;Epidemics: Models and Data using R&quot; by Ottar Bjornstad, Chapter 4-3</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(epimdr)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> shiny</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> deSolve</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> polspline</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">data</span>(black)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="do">## Subsetting to specific age brackets</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> black[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">9</span>),]</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(b2)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">age</th>
<th align="right">mid</th>
<th align="right">n</th>
<th align="right">pos</th>
<th align="right">neg</th>
<th align="right">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">1-4</td>
<td align="right">2.5</td>
<td align="right">21</td>
<td align="right">4</td>
<td align="right">17</td>
<td align="right">0.1904762</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">5-9</td>
<td align="right">7.0</td>
<td align="right">41</td>
<td align="right">31</td>
<td align="right">10</td>
<td align="right">0.7560976</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">10-14</td>
<td align="right">12.0</td>
<td align="right">52</td>
<td align="right">50</td>
<td align="right">2</td>
<td align="right">0.9615385</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">15-19</td>
<td align="right">17.0</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="right">2</td>
<td align="right">0.9333333</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">20-29</td>
<td align="right">25.0</td>
<td align="right">38</td>
<td align="right">37</td>
<td align="right">1</td>
<td align="right">0.9736842</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">30-39</td>
<td align="right">35.0</td>
<td align="right">51</td>
<td align="right">49</td>
<td align="right">2</td>
<td align="right">0.9607843</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## [1] MLE method to estimate FOI</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(pos,neg) <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(mid)), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;cloglog&quot;</span>), <span class="at">data=</span>b2)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">exp</span>(fit<span class="sc">$</span>coef)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="cn">FALSE</span> (Intercept) </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="cn">FALSE</span>   <span class="fl">0.1653329</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## Plot predicted and observed</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>phi<span class="sc">*</span>x), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">60</span>, <span class="at">ylab=</span><span class="st">&quot;Seroprevalence&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">points</span>(black<span class="sc">$</span>mid, black<span class="sc">$</span>f, <span class="at">pch=</span><span class="st">&quot;*&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">points</span>(b2<span class="sc">$</span>mid, b2<span class="sc">$</span>f, <span class="at">pch=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="serocatalytic_model_files/figure-html/unnamed-chunk-3-1.png" width="700" /></p>
<p>Now we try the Stan version, implementing the FOI (lambda parameter)
inference using MCMC</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">## [2] Fit this model in Stan</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>fit_Stan <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">sampling</span>(<span class="fu">get_stan_models</span>()<span class="sc">$</span>model_serocatalytic,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                 <span class="at">data=</span><span class="fu">list</span>(<span class="at">AGE_GROUPS =</span> <span class="fu">nrow</span>(b2),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                           <span class="at">age_mid =</span> b2<span class="sc">$</span>mid,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                           <span class="at">N =</span> b2<span class="sc">$</span>n,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                           <span class="at">n_seropos =</span> b2<span class="sc">$</span>pos))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="cn">FALSE</span> SAMPLING FOR MODEL <span class="st">&#39;model_serocatalytic&#39;</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">2.7e-05</span> seconds</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.27</span> seconds.</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.05</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.046</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.096</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="cn">FALSE</span> SAMPLING FOR MODEL <span class="st">&#39;model_serocatalytic&#39;</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>   Stan can<span class="st">&#39;t start sampling from this initial value.</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="st">FALSE Chain 2: Rejecting initial value:</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="st">FALSE Chain 2:   Log probability evaluates to log(0), i.e. negative infinity.</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="st">FALSE Chain 2:   Stan can&#39;</span>t start sampling from this initial value.</span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>   Stan can<span class="st">&#39;t start sampling from this initial value.</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="st">FALSE Chain 2: Rejecting initial value:</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="st">FALSE Chain 2:   Log probability evaluates to log(0), i.e. negative infinity.</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="st">FALSE Chain 2:   Stan can&#39;</span>t start sampling from this initial value.</span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>   Stan can<span class="st">&#39;t start sampling from this initial value.</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="st">FALSE Chain 2: </span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="st">FALSE Chain 2: Gradient evaluation took 1.2e-05 seconds</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="st">FALSE Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="st">FALSE Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="st">FALSE Chain 2: </span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="st">FALSE Chain 2: </span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a><span class="st">FALSE Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a><span class="st">FALSE Chain 2: </span></span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a><span class="st">FALSE Chain 2:  Elapsed Time: 0.05 seconds (Warm-up)</span></span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a><span class="st">FALSE Chain 2:                0.051 seconds (Sampling)</span></span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a><span class="st">FALSE Chain 2:                0.101 seconds (Total)</span></span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a><span class="st">FALSE Chain 2: </span></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a><span class="st">FALSE </span></span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a><span class="st">FALSE SAMPLING FOR MODEL &#39;</span>model_serocatalytic<span class="st">&#39; NOW (CHAIN 3).</span></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a><span class="st">FALSE Chain 3: Rejecting initial value:</span></span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a><span class="st">FALSE Chain 3:   Log probability evaluates to log(0), i.e. negative infinity.</span></span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a><span class="st">FALSE Chain 3:   Stan can&#39;</span>t start sampling from this initial value.</span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>   Stan can<span class="st">&#39;t start sampling from this initial value.</span></span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a><span class="st">FALSE Chain 3: Rejecting initial value:</span></span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a><span class="st">FALSE Chain 3:   Log probability evaluates to log(0), i.e. negative infinity.</span></span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a><span class="st">FALSE Chain 3:   Stan can&#39;</span>t start sampling from this initial value.</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>   Stan can<span class="st">&#39;t start sampling from this initial value.</span></span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a><span class="st">FALSE Chain 3: </span></span>
<span id="cb4-88"><a href="#cb4-88" tabindex="-1"></a><span class="st">FALSE Chain 3: Gradient evaluation took 1.2e-05 seconds</span></span>
<span id="cb4-89"><a href="#cb4-89" tabindex="-1"></a><span class="st">FALSE Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.12 seconds.</span></span>
<span id="cb4-90"><a href="#cb4-90" tabindex="-1"></a><span class="st">FALSE Chain 3: Adjust your expectations accordingly!</span></span>
<span id="cb4-91"><a href="#cb4-91" tabindex="-1"></a><span class="st">FALSE Chain 3: </span></span>
<span id="cb4-92"><a href="#cb4-92" tabindex="-1"></a><span class="st">FALSE Chain 3: </span></span>
<span id="cb4-93"><a href="#cb4-93" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb4-94"><a href="#cb4-94" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb4-95"><a href="#cb4-95" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb4-96"><a href="#cb4-96" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb4-97"><a href="#cb4-97" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb4-98"><a href="#cb4-98" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb4-99"><a href="#cb4-99" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb4-100"><a href="#cb4-100" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb4-101"><a href="#cb4-101" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb4-102"><a href="#cb4-102" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb4-103"><a href="#cb4-103" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb4-104"><a href="#cb4-104" tabindex="-1"></a><span class="st">FALSE Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb4-105"><a href="#cb4-105" tabindex="-1"></a><span class="st">FALSE Chain 3: </span></span>
<span id="cb4-106"><a href="#cb4-106" tabindex="-1"></a><span class="st">FALSE Chain 3:  Elapsed Time: 0.049 seconds (Warm-up)</span></span>
<span id="cb4-107"><a href="#cb4-107" tabindex="-1"></a><span class="st">FALSE Chain 3:                0.047 seconds (Sampling)</span></span>
<span id="cb4-108"><a href="#cb4-108" tabindex="-1"></a><span class="st">FALSE Chain 3:                0.096 seconds (Total)</span></span>
<span id="cb4-109"><a href="#cb4-109" tabindex="-1"></a><span class="st">FALSE Chain 3: </span></span>
<span id="cb4-110"><a href="#cb4-110" tabindex="-1"></a><span class="st">FALSE </span></span>
<span id="cb4-111"><a href="#cb4-111" tabindex="-1"></a><span class="st">FALSE SAMPLING FOR MODEL &#39;</span>model_serocatalytic<span class="st">&#39; NOW (CHAIN 4).</span></span>
<span id="cb4-112"><a href="#cb4-112" tabindex="-1"></a><span class="st">FALSE Chain 4: </span></span>
<span id="cb4-113"><a href="#cb4-113" tabindex="-1"></a><span class="st">FALSE Chain 4: Gradient evaluation took 1.3e-05 seconds</span></span>
<span id="cb4-114"><a href="#cb4-114" tabindex="-1"></a><span class="st">FALSE Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.13 seconds.</span></span>
<span id="cb4-115"><a href="#cb4-115" tabindex="-1"></a><span class="st">FALSE Chain 4: Adjust your expectations accordingly!</span></span>
<span id="cb4-116"><a href="#cb4-116" tabindex="-1"></a><span class="st">FALSE Chain 4: </span></span>
<span id="cb4-117"><a href="#cb4-117" tabindex="-1"></a><span class="st">FALSE Chain 4: </span></span>
<span id="cb4-118"><a href="#cb4-118" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb4-119"><a href="#cb4-119" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb4-120"><a href="#cb4-120" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb4-121"><a href="#cb4-121" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb4-122"><a href="#cb4-122" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb4-123"><a href="#cb4-123" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb4-124"><a href="#cb4-124" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb4-125"><a href="#cb4-125" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb4-126"><a href="#cb4-126" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb4-127"><a href="#cb4-127" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb4-128"><a href="#cb4-128" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb4-129"><a href="#cb4-129" tabindex="-1"></a><span class="st">FALSE Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb4-130"><a href="#cb4-130" tabindex="-1"></a><span class="st">FALSE Chain 4: </span></span>
<span id="cb4-131"><a href="#cb4-131" tabindex="-1"></a><span class="st">FALSE Chain 4:  Elapsed Time: 0.049 seconds (Warm-up)</span></span>
<span id="cb4-132"><a href="#cb4-132" tabindex="-1"></a><span class="st">FALSE Chain 4:                0.05 seconds (Sampling)</span></span>
<span id="cb4-133"><a href="#cb4-133" tabindex="-1"></a><span class="st">FALSE Chain 4:                0.099 seconds (Total)</span></span>
<span id="cb4-134"><a href="#cb4-134" tabindex="-1"></a><span class="st">FALSE Chain 4:</span></span>
<span id="cb4-135"><a href="#cb4-135" tabindex="-1"></a></span>
<span id="cb4-136"><a href="#cb4-136" tabindex="-1"></a><span class="st">## Look at output</span></span>
<span id="cb4-137"><a href="#cb4-137" tabindex="-1"></a><span class="st">fit_Stan</span></span>
<span id="cb4-138"><a href="#cb4-138" tabindex="-1"></a><span class="st">FALSE Inference for Stan model: model_serocatalytic.</span></span>
<span id="cb4-139"><a href="#cb4-139" tabindex="-1"></a><span class="st">FALSE 4 chains, each with iter=2000; warmup=1000; thin=1; </span></span>
<span id="cb4-140"><a href="#cb4-140" tabindex="-1"></a><span class="st">FALSE post-warmup draws per chain=1000, total post-warmup draws=4000.</span></span>
<span id="cb4-141"><a href="#cb4-141" tabindex="-1"></a><span class="st">FALSE </span></span>
<span id="cb4-142"><a href="#cb4-142" tabindex="-1"></a><span class="st">FALSE              mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat</span></span>
<span id="cb4-143"><a href="#cb4-143" tabindex="-1"></a><span class="st">FALSE log_lambda  -1.80    0.00 0.10  -2.00  -1.87  -1.80  -1.73  -1.61  1598    1</span></span>
<span id="cb4-144"><a href="#cb4-144" tabindex="-1"></a><span class="st">FALSE lambda       0.17    0.00 0.02   0.14   0.15   0.17   0.18   0.20  1616    1</span></span>
<span id="cb4-145"><a href="#cb4-145" tabindex="-1"></a><span class="st">FALSE lp__       -70.31    0.02 0.72 -72.37 -70.47 -70.03 -69.86 -69.81  1706    1</span></span>
<span id="cb4-146"><a href="#cb4-146" tabindex="-1"></a><span class="st">FALSE </span></span>
<span id="cb4-147"><a href="#cb4-147" tabindex="-1"></a><span class="st">FALSE Samples were drawn using NUTS(diag_e) at Thu Dec 14 17:12:14 2023.</span></span>
<span id="cb4-148"><a href="#cb4-148" tabindex="-1"></a><span class="st">FALSE For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb4-149"><a href="#cb4-149" tabindex="-1"></a><span class="st">FALSE and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span id="cb4-150"><a href="#cb4-150" tabindex="-1"></a><span class="st">FALSE convergence, Rhat=1).</span></span>
<span id="cb4-151"><a href="#cb4-151" tabindex="-1"></a></span>
<span id="cb4-152"><a href="#cb4-152" tabindex="-1"></a><span class="st">mcmc_trace(fit_Stan, pars=&quot;lambda&quot;)</span></span></code></pre></div>
<p><img src="serocatalytic_model_files/figure-html/unnamed-chunk-4-1.png" width="700" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">mcmc_areas</span>(fit_Stan, <span class="at">pars=</span><span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<p><img src="serocatalytic_model_files/figure-html/unnamed-chunk-4-2.png" width="700" /></p>
<p>The stan model looks like this:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode stan"><code class="sourceCode stan"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; AGE_GROUPS;</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="dt">vector</span>[AGE_GROUPS] age_mid;</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N[AGE_GROUPS];</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; n_seropos[AGE_GROUPS];</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="co">// log FOI</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="dt">real</span> log_lambda;</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>}</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  </span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="co">// FOI</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="fl">0.0</span>&gt; lambda;</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  </span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  lambda = exp(log_lambda);</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>}</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span>:AGE_GROUPS) n_seropos[a] ~ binomial(N[a], <span class="fl">1.0</span>-exp(-lambda*age_mid[a]));</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="extensions" class="section level2">
<h2>Extensions</h2>
<div id="time--and-age-varying-foi" class="section level3">
<h3>Time- and age-varying FOI</h3>
<p>If FOI is not assumed to be constant and varies by age or time (for
example due to the introduction of a new intervention), then the FOI may
be calculated as a function of time or age <span
class="math inline">\(\lambda(t)\)</span>, or as multiple parameter
values covering different time periods.</p>
<p>&lt;&lt; NOTE: where did this equation come from? &gt;&gt; Discrete
age varying FOI (one change point): <span class="math display">\[
\pi(a,t) = 1-exp( -[ \lambda_{1}(a-(t - \gamma_{1}))+\lambda_{2}(t -
\gamma_{2})])
\]</span></p>
<p>Time-varying, discrete FOI: <span class="math display">\[
\pi(a,t) = 1-exp (\sum_{i = t - a +1   }^{i= t} \lambda_{i} )
\]</span> This model has been implemented as part of the <a
href="https://epiverse-trace.github.io/serofoi/index.html">serofoi</a> R
package, described <a
href="https://epiverse-trace.github.io/serofoi/articles/foi_models.html">here</a>.</p>
<p>Time-varying FOI as a function of time: <span class="math display">\[
\pi(a, t) = 1 - exp(-\int_{t-a}^{a} \lambda(u)du)
\]</span></p>
</div>
<div id="accounting-seroreversion" class="section level3">
<h3>Accounting seroreversion</h3>
<p>In many infectious diseases, antibody response will wane over time to
the point that individuals who were previously infected may become
seronegative. To account for this, we usea reversible serocatalytic
model which includes a seroreversion parameter,<span
class="math inline">\(ρ\)</span>. Parameters of this model are:</p>
<ol style="list-style-type: decimal">
<li>Seroconversion rate,<span class="math inline">\(λ\)</span>, the mean
annual rate of seroconversion (negative to positive)</li>
<li>Seroreversion rate, <span class="math inline">\(ρ\)</span>, the mean
annual rate of seroreversion(positive to negative). <span
class="math inline">\(1/ρ\)</span> is the antibody persistence duration
in years</li>
</ol>
<p>The proportion seropositive at age <span
class="math inline">\(a\)</span> can again be solved analytically
as:</p>
<p><span class="math display">\[
\pi(a)=\frac{\lambda}{ \lambda +\rho}(1−exp(−a(\lambda+\rho))
\]</span></p>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<p><a
href="https://journals.plos.org/plosntds/article?id=10.1371/journal.pntd.0010506"
class="uri">https://journals.plos.org/plosntds/article?id=10.1371/journal.pntd.0010506</a>
<a href="https://doi.org/10.1017/S0950268809990781"
class="uri">https://doi.org/10.1017/S0950268809990781</a></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Hay.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="seroepirecipes">
<title> Serocatalytic Model Family • seroepirecipes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content=" Serocatalytic Model Family">
<meta property="og:description" content="seroepirecipes">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seroepirecipes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/serocatalytic_model.html"> Serocatalytic Model Family</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/seroanalytics/seroepirecipes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1> Serocatalytic Model Family</h1>
                        <h4 data-toc-skip class="author">James Hay,
Isobel Routledge and Saki Takahashi</h4>
            
            <h4 data-toc-skip class="date">2023-12-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/seroanalytics/seroepirecipes/blob/HEAD/vignettes/serocatalytic_model.Rmd" class="external-link"><code>vignettes/serocatalytic_model.Rmd</code></a></small>
      <div class="d-none name"><code>serocatalytic_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="serocatalytic-models">Serocatalytic models<a class="anchor" aria-label="anchor" href="#serocatalytic-models"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Serocatalytic models are used to model and infer the Force of
Infection (FOI), which is the per capita rate (per year) that
susceptible individuals are exposed to infection, from cross - sectional
serological surveys</p>
<p>The simplest catalytic model assumes:</p>
<ul>
<li>Force of Infection is constant between ages and over time</li>
<li>No sero-reversion (loss of seropositivity after infection)</li>
<li>No boosting of antibody response</li>
<li>No cross-reactivity</li>
<li>Stable population size and characteristics</li>
</ul>
<p>Under this model, the rate of change of susceptible individuals
(<span class="math inline">\(S\)</span>) with age (<span class="math inline">\(a\)</span>) is expressed as</p>
<p><span class="math display">\[
\frac{dS}{dt} = -\lambda S(a)
\]</span> where <span class="math inline">\(\lambda\)</span> is the
constant FOI.</p>
<p>The proportion of the population seropositive at age <span class="math inline">\(a\)</span>, <span class="math inline">\(P_{a}\)</span> can be given as <span class="math display">\[
P_{a}= 1-exp(-\lambda a)
\]</span></p>
<p>Note either age (<span class="math inline">\(a\)</span>) or time
(<span class="math inline">\(t\)</span>) could be used in the example
above. Here we define seropositive as individuals whose serum gave an
ELISA value above the normal range for serum from nonexposed
individuals.</p>
</div>
<div class="section level3">
<h3 id="variables-required">Variables required<a class="anchor" aria-label="anchor" href="#variables-required"></a>
</h3>
<p>Minimum variables required for this model to identify the population
wide FOI would be the proportion seropositive by age group.
Additionally, having seropositivity at multiple timepoints can allow an
assessment of changes in FOI over time. Differences in FOI between
sub-populations or demographic groups can also be measured using
serocatalytic models (see Table 1)</p>
<table class="table">
<caption>Table 1 : Minimum variables required for serocatalytic model
depending on use case</caption>
<colgroup>
<col width="45%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th align="left">Use case</th>
<th align="left">Minimum variables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Population-wide FOI</td>
<td align="left">proportion seropositive, age</td>
</tr>
<tr class="even">
<td align="left">Age-specific FOI</td>
<td align="left">proportion seropositive, age</td>
</tr>
<tr class="odd">
<td align="left">Changes in FOI over time</td>
<td align="left">proportion seropositive, age, time</td>
</tr>
<tr class="even">
<td align="left">Changes in FOI in different populations</td>
<td align="left">proportion seropositive, age, time, population</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-fitting-a-basic-serocatalytic-model-in-stan">Example: Fitting a basic serocatalytic model in Stan<a class="anchor" aria-label="anchor" href="#example-fitting-a-basic-serocatalytic-model-in-stan"></a>
</h3>
<p>For this example, we are fitting to a dataset from the book
“Epidemics: Models and Data using R” by Ottar Bjornstad, Chapter 4-3. We
can see that we have age bands, the median age within that band, the
number of samples in that band, the number positive and negative, and
the seroprevalence in that age band (f). For this example we will subset
the data, excluding the &lt;1, 40-49 and 50+ brackets.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## For now, fit to data from "Epidemics: Models and Data using R" by Ottar Bjornstad, Chapter 4-3</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(epimdr)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> shiny</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> deSolve</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> polspline</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> StanHeaders</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="cn">FALSE</span> Loading required package<span class="sc">:</span> ggplot2</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="cn">FALSE</span> <span class="fu">rstan</span> (Version <span class="dv">2</span>.<span class="fl">21.8</span>, GitRev<span class="sc">:</span> <span class="fl">2e1</span>f913d3ca3)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="cn">FALSE</span> For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="cn">FALSE</span> <span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()).</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="cn">FALSE</span> To avoid recompilation of unchanged Stan programs, we recommend calling</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="cn">FALSE</span> <span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="cn">FALSE</span> This is bayesplot version <span class="dv">1</span>.<span class="fl">10.0</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">-</span> Online documentation and vignettes at mc<span class="sc">-</span>stan.org<span class="sc">/</span>bayesplot</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">-</span> bayesplot theme set to bayesplot<span class="sc">::</span><span class="fu">theme_default</span>()</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="cn">FALSE</span>    <span class="sc">*</span> Does _not_ affect other ggplot2 plots</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="cn">FALSE</span>    <span class="sc">*</span> See ?bayesplot_theme_set <span class="cf">for</span> details on theme setting</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="fu">data</span>(black)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="do">## Subsetting to specific age brackets</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> black[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">9</span>),]</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(b2)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">age</th>
<th align="right">mid</th>
<th align="right">n</th>
<th align="right">pos</th>
<th align="right">neg</th>
<th align="right">f</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">1-4</td>
<td align="right">2.5</td>
<td align="right">21</td>
<td align="right">4</td>
<td align="right">17</td>
<td align="right">0.1904762</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">5-9</td>
<td align="right">7.0</td>
<td align="right">41</td>
<td align="right">31</td>
<td align="right">10</td>
<td align="right">0.7560976</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">10-14</td>
<td align="right">12.0</td>
<td align="right">52</td>
<td align="right">50</td>
<td align="right">2</td>
<td align="right">0.9615385</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">15-19</td>
<td align="right">17.0</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="right">2</td>
<td align="right">0.9333333</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">20-29</td>
<td align="right">25.0</td>
<td align="right">38</td>
<td align="right">37</td>
<td align="right">1</td>
<td align="right">0.9736842</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">30-39</td>
<td align="right">35.0</td>
<td align="right">51</td>
<td align="right">49</td>
<td align="right">2</td>
<td align="right">0.9607843</td>
</tr>
</tbody>
</table>
<p>Next we get just the maximum likelihood estimate for Force of
Infection.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## [1] MLE method to estimate FOI</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(pos,neg) <span class="sc">~</span> <span class="fu">offset</span>(<span class="fu">log</span>(mid)), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"cloglog"</span>), <span class="at">data=</span>b2)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">exp</span>(fit<span class="sc">$</span>coef)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="cn">FALSE</span> (Intercept) </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="cn">FALSE</span>   <span class="fl">0.1653329</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="do">## Plot predicted and observed</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit))</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>phi<span class="sc">*</span>x), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">60</span>, <span class="at">ylab=</span><span class="st">"Seroprevalence"</span>, <span class="at">xlab=</span><span class="st">"Age"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">points</span>(black<span class="sc">$</span>mid, black<span class="sc">$</span>f, <span class="at">pch=</span><span class="st">"*"</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">points</span>(b2<span class="sc">$</span>mid, b2<span class="sc">$</span>f, <span class="at">pch=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="serocatalytic_model_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Now we try the stan version, implementing the FOI (lambda parameter)
inference using MCMC</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="do">## [2] Fit this model in Stan</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>fit_Stan <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">file=</span><span class="st">"model_serocatalytic.stan"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                 <span class="at">data=</span><span class="fu">list</span>(<span class="at">AGE_GROUPS =</span> <span class="fu">nrow</span>(b2),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                           <span class="at">age_mid =</span> b2<span class="sc">$</span>mid,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                           <span class="at">N =</span> b2<span class="sc">$</span>n,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                           <span class="at">n_seropos =</span> b2<span class="sc">$</span>pos))</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="cn">FALSE</span> SAMPLING FOR MODEL <span class="st">'model_serocatalytic'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>   Stan can<span class="st">'t start sampling from this initial value.</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="st">FALSE Chain 1: Rejecting initial value:</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="st">FALSE Chain 1:   Log probability evaluates to log(0), i.e. negative infinity.</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="st">FALSE Chain 1:   Stan can'</span>t start sampling from this initial value.</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">2e-05</span> seconds</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.2</span> seconds.</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.005673</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.006154</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.011827</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="cn">FALSE</span> SAMPLING FOR MODEL <span class="st">'model_serocatalytic'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Gradient evaluation took <span class="fl">5e-06</span> seconds</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.05</span> seconds.</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.005865</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.005703</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.011568</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a><span class="cn">FALSE</span> SAMPLING FOR MODEL <span class="st">'model_serocatalytic'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">3</span>).</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Rejecting initial value<span class="sc">:</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>   Log probability evaluates to <span class="fu">log</span>(<span class="dv">0</span>), i.e. negative infinity.</span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>   Stan can<span class="st">'t start sampling from this initial value.</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a><span class="st">FALSE Chain 3: Rejecting initial value:</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="st">FALSE Chain 3:   Log probability evaluates to log(0), i.e. negative infinity.</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="st">FALSE Chain 3:   Stan can'</span>t start sampling from this initial value.</span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Gradient evaluation took <span class="fl">4e-06</span> seconds</span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.04</span> seconds.</span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.005761</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.005163</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.010924</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb3-95"><a href="#cb3-95" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb3-96"><a href="#cb3-96" tabindex="-1"></a><span class="cn">FALSE</span> SAMPLING FOR MODEL <span class="st">'model_serocatalytic'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">4</span>).</span>
<span id="cb3-97"><a href="#cb3-97" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb3-98"><a href="#cb3-98" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Gradient evaluation took <span class="fl">5e-06</span> seconds</span>
<span id="cb3-99"><a href="#cb3-99" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.05</span> seconds.</span>
<span id="cb3-100"><a href="#cb3-100" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb3-101"><a href="#cb3-101" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb3-102"><a href="#cb3-102" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb3-103"><a href="#cb3-103" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb3-104"><a href="#cb3-104" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb3-105"><a href="#cb3-105" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb3-106"><a href="#cb3-106" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb3-107"><a href="#cb3-107" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb3-108"><a href="#cb3-108" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb3-109"><a href="#cb3-109" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb3-110"><a href="#cb3-110" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb3-111"><a href="#cb3-111" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb3-112"><a href="#cb3-112" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb3-113"><a href="#cb3-113" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb3-114"><a href="#cb3-114" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb3-115"><a href="#cb3-115" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb3-116"><a href="#cb3-116" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.005759</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb3-117"><a href="#cb3-117" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.005562</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb3-118"><a href="#cb3-118" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.011321</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb3-119"><a href="#cb3-119" tabindex="-1"></a><span class="cn">FALSE</span> Chain <span class="dv">4</span><span class="sc">:</span></span>
<span id="cb3-120"><a href="#cb3-120" tabindex="-1"></a></span>
<span id="cb3-121"><a href="#cb3-121" tabindex="-1"></a><span class="do">## Look at output</span></span>
<span id="cb3-122"><a href="#cb3-122" tabindex="-1"></a>fit_Stan</span>
<span id="cb3-123"><a href="#cb3-123" tabindex="-1"></a><span class="cn">FALSE</span> Inference <span class="cf">for</span> Stan model<span class="sc">:</span> model_serocatalytic.</span>
<span id="cb3-124"><a href="#cb3-124" tabindex="-1"></a><span class="cn">FALSE</span> <span class="dv">4</span> chains, each with iter<span class="ot">=</span><span class="dv">2000</span>; warmup<span class="ot">=</span><span class="dv">1000</span>; thin<span class="ot">=</span><span class="dv">1</span>; </span>
<span id="cb3-125"><a href="#cb3-125" tabindex="-1"></a><span class="cn">FALSE</span> post<span class="sc">-</span>warmup draws per chain<span class="ot">=</span><span class="dv">1000</span>, total post<span class="sc">-</span>warmup draws<span class="ot">=</span><span class="fl">4000.</span></span>
<span id="cb3-126"><a href="#cb3-126" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb3-127"><a href="#cb3-127" tabindex="-1"></a><span class="cn">FALSE</span>              mean se_mean   sd   <span class="fl">2.5</span><span class="sc">%    25%</span>    <span class="dv">50</span><span class="sc">%    75%</span>  <span class="fl">97.5</span>% n_eff Rhat</span>
<span id="cb3-128"><a href="#cb3-128" tabindex="-1"></a><span class="cn">FALSE</span> log_lambda  <span class="sc">-</span><span class="fl">1.80</span>    <span class="fl">0.00</span> <span class="fl">0.10</span>  <span class="sc">-</span><span class="fl">1.99</span>  <span class="sc">-</span><span class="fl">1.86</span>  <span class="sc">-</span><span class="fl">1.80</span>  <span class="sc">-</span><span class="fl">1.73</span>  <span class="sc">-</span><span class="fl">1.61</span>  <span class="dv">1589</span>    <span class="dv">1</span></span>
<span id="cb3-129"><a href="#cb3-129" tabindex="-1"></a><span class="cn">FALSE</span> lambda       <span class="fl">0.17</span>    <span class="fl">0.00</span> <span class="fl">0.02</span>   <span class="fl">0.14</span>   <span class="fl">0.15</span>   <span class="fl">0.17</span>   <span class="fl">0.18</span>   <span class="fl">0.20</span>  <span class="dv">1581</span>    <span class="dv">1</span></span>
<span id="cb3-130"><a href="#cb3-130" tabindex="-1"></a><span class="cn">FALSE</span> lp__       <span class="sc">-</span><span class="fl">70.29</span>    <span class="fl">0.02</span> <span class="fl">0.66</span> <span class="sc">-</span><span class="fl">72.10</span> <span class="sc">-</span><span class="fl">70.46</span> <span class="sc">-</span><span class="fl">70.04</span> <span class="sc">-</span><span class="fl">69.86</span> <span class="sc">-</span><span class="fl">69.81</span>  <span class="dv">1525</span>    <span class="dv">1</span></span>
<span id="cb3-131"><a href="#cb3-131" tabindex="-1"></a><span class="cn">FALSE</span> </span>
<span id="cb3-132"><a href="#cb3-132" tabindex="-1"></a><span class="cn">FALSE</span> Samples were drawn using <span class="fu">NUTS</span>(diag_e) at Thu Dec <span class="dv">14</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">53</span><span class="sc">:</span><span class="dv">42</span> <span class="fl">2023.</span></span>
<span id="cb3-133"><a href="#cb3-133" tabindex="-1"></a><span class="cn">FALSE</span> For each parameter, n_eff is a crude measure of effective sample size,</span>
<span id="cb3-134"><a href="#cb3-134" tabindex="-1"></a><span class="cn">FALSE</span> and Rhat is the potential scale reduction factor on split <span class="fu">chains</span> (at </span>
<span id="cb3-135"><a href="#cb3-135" tabindex="-1"></a><span class="cn">FALSE</span> convergence, <span class="at">Rhat=</span><span class="dv">1</span>).</span>
<span id="cb3-136"><a href="#cb3-136" tabindex="-1"></a></span>
<span id="cb3-137"><a href="#cb3-137" tabindex="-1"></a><span class="fu">mcmc_trace</span>(fit_Stan, <span class="at">pars=</span><span class="st">"lambda"</span>)</span></code></pre></div>
<p><img src="serocatalytic_model_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">fit_Stan</span>, pars<span class="op">=</span><span class="st">"lambda"</span><span class="op">)</span></span></code></pre></div>
<p><img src="serocatalytic_model_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>The stan model looks like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; AGE_GROUPS;</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="dt">vector</span>[AGE_GROUPS] age_mid;</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N[AGE_GROUPS];</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; n_seropos[AGE_GROUPS];</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>}</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="co">// log FOI</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="dt">real</span> log_lambda;</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  </span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="co">// FOI</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="fl">0.0</span>&gt; lambda;</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>  </span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>  lambda = exp(log_lambda);</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>}</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>  </span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  <span class="cf">for</span>(a <span class="cf">in</span> <span class="dv">1</span>:AGE_GROUPS) n_seropos[a] ~ binomial(N[a], <span class="fl">1.0</span>-exp(-lambda*age_mid[a]));</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extension-1--time-or-age-varying-foi">Extension 1- Time or age-varying FOI<a class="anchor" aria-label="anchor" href="#extension-1--time-or-age-varying-foi"></a>
</h3>
<p>If FOI is not assumed to be constant and varies by age or time (for
example due to the introduction of a new intervention), then multiple
<span class="math inline">\(\lambda\)</span> values may need to be
estimated</p>
<p>Discrete age varying FOI <span class="math display">\[
P_{a,\tau} = 1-exp( -[ \lambda_{1}(a-(\tau -
\gamma_{1}))+\lambda_{2}(\tau - \gamma_{2})])
\]</span></p>
<p>Seasonally varying FOI <span class="math display">\[
P_{a,\tau} = 1-exp (\sum_{i = \tau - a +1   }^{i= \tau} \lambda_{i} )
\]</span></p>
</div>
<div class="section level3">
<h3 id="extension-2---seroreversion">Extension 2 - Seroreversion<a class="anchor" aria-label="anchor" href="#extension-2---seroreversion"></a>
</h3>
<p>In many infectious diseases, antibody response will wane over time to
the point that individuals who were previously infected may be
seronegative. To account for this, we use what is called a reverse
serocatalytic model which includes a seroreversion parameter,<span class="math inline">\(ρ\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Seroconversion rate,<span class="math inline">\(λ\)</span> , mean
annual rate of seroconversion (negative to positive)</li>
<li>Seroreversion rate, <span class="math inline">\(ρ\)</span>, mean
annual rate of seroreversion(positive to negative) <span class="math inline">\(1/ρ\)</span> is the antibody persistence duration
in years</li>
</ol>
<p>From this, the proportion seropositive at age <span class="math inline">\(a\)</span> is expressed as</p>
<p><span class="math display">\[
P_{a}=\frac{λ}{ λ +ρ}(1−exp(−a(λ+ρ))
\]</span></p>
</div>
<div class="section level3">
<h3 id="extension-3---boosting">Extension 3 - Boosting<a class="anchor" aria-label="anchor" href="#extension-3---boosting"></a>
</h3>
<p>To model multiple infections</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p><a href="https://journals.plos.org/plosntds/article?id=10.1371/journal.pntd.0010506" class="external-link uri">https://journals.plos.org/plosntds/article?id=10.1371/journal.pntd.0010506</a>
<a href="https://doi.org/10.1017/S0950268809990781" class="external-link uri">https://doi.org/10.1017/S0950268809990781</a></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by James Hay.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
